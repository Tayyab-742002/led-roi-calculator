<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Visual Simple Economic Tool</title>
    <style>
      /* CSS Reset and Base Styles */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        --primary-color: #1c367e;
        --secondary-color: #38a169;
        --accent-color: #3182ce;
        --background-color: #f8f9fa;
        --surface-color: #ffffff;
        --text-primary: #333333;
        --text-secondary: #6c757d;
        --border-color: #dee2e6;
        --shadow-light: 0 2px 8px rgba(0, 0, 0, 0.1);
        --shadow-medium: 0 4px 16px rgba(0, 0, 0, 0.15);
        --border-radius: 8px;
        --transition: all 0.3s ease;
        --spacing-xs: 0.5rem;
        --spacing-sm: 1rem;
        --spacing-md: 1.5rem;
        --spacing-lg: 2rem;
        --spacing-xl: 3rem;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: var(--background-color);
        color: var(--text-primary);
        line-height: 1.6;
        min-height: 100vh;
        font-size: 16px;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: var(--spacing-sm);
      }

      /* Header Styles */
      .header {
        background: linear-gradient(
          135deg,
          var(--surface-color) 0%,
          #f8f9fa 100%
        );
        color: var(--text-primary);
        padding: var(--spacing-md);
        border-radius: var(--border-radius);
        margin-bottom: var(--spacing-lg);
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: var(--spacing-md);
        border: 1px solid var(--border-color);
        box-shadow: var(--shadow-light);
      }

      .header-left {
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
        flex-wrap: wrap;
      }

      .logo {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
      }

      .logo svg {
        width: 60px;
        height: 50px;
        filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
      }

      .header h1 {
        font-size: clamp(1.5rem, 4vw, 2.5rem);
        font-weight: 300;
        margin: 0;
        color: var(--text-primary);
        line-height: 1.2;
      }

      .header-buttons {
        display: flex;
        gap: var(--spacing-sm);
        flex-wrap: wrap;
        align-items: center;
      }

      .btn {
        padding: 0.75rem 1.5rem;
        border: none;
        border-radius: var(--border-radius);
        cursor: pointer;
        font-weight: 600;
        font-size: 0.875rem;
        transition: var(--transition);
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        white-space: nowrap;
        min-height: 44px;
      }

      .btn-primary {
        background: linear-gradient(135deg, #e4efc0 0%, #abbd73 100%);
        color: var(--text-primary);
        box-shadow: var(--shadow-light);
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-medium);
      }

      .btn-secondary {
        background: var(--surface-color);
        color: var(--text-primary);
        border: 1px solid var(--border-color);
      }

      .btn-secondary:hover {
        background: #e9ecef;
        border-color: #adb5bd;
        transform: translateY(-1px);
      }

      /* General Inputs Section */
      .general-inputs {
        background: var(--surface-color);
        padding: var(--spacing-md);
        border-radius: var(--border-radius);
        margin-bottom: var(--spacing-lg);
        box-shadow: var(--shadow-light);
        border: 1px solid var(--border-color);
      }

      .general-inputs h2 {
        color: var(--text-primary);
        margin-bottom: var(--spacing-md);
        font-size: 1.5rem;
        font-weight: 600;
      }

      .input-group {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: var(--spacing-md);
        align-items: end;
      }

      .input-field {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-xs);
      }

      .input-field label {
        font-weight: 600;
        color: var(--text-primary);
        font-size: 0.875rem;
      }

      .input-field input {
        padding: 0.75rem;
        border: 1px solid var(--border-color);
        border-radius: var(--border-radius);
        font-size: 1rem;
        transition: var(--transition);
        background: var(--surface-color);
        width: 100%;
      }

      .input-field input:focus {
        outline: none;
        border-color: var(--accent-color);
        box-shadow: 0 0 0 3px rgba(56, 130, 206, 0.1);
      }

      .unit-label {
        background: var(--text-secondary);
        color: white;
        padding: 0.75rem;
        border-radius: var(--border-radius);
        font-weight: 600;
        font-size: 0.875rem;
        text-align: center;
        white-space: nowrap;
        align-self: end;
      }

      /* Comparison Sections */
      .comparison-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: var(--spacing-lg);
        margin-bottom: var(--spacing-lg);
      }

      .comparison-section {
        background: var(--surface-color);
        padding: var(--spacing-lg);
        border-radius: var(--border-radius);
        box-shadow: var(--shadow-light);
        border: 1px solid var(--border-color);
      }

      .comparison-section h2 {
        color: var(--text-primary);
        margin-bottom: var(--spacing-md);
        font-size: 1.5rem;
        text-align: left;
        font-weight: 600;
      }

      .baseline h2 {
        color: var(--accent-color);
      }

      .proposed h2 {
        color: var(--secondary-color);
      }

      .form-group {
        margin-bottom: var(--spacing-md);
        display: flex;
        flex-direction: column;
        gap: var(--spacing-xs);
      }

      .form-group label {
        font-weight: 600;
        color: var(--text-primary);
        font-size: 0.875rem;
      }

      .form-group input,
      .form-group select {
        padding: 0.75rem;
        border: 1px solid var(--border-color);
        border-radius: var(--border-radius);
        font-size: 1rem;
        transition: var(--transition);
        background: var(--surface-color);
        width: 100%;
      }

      .form-group input:focus,
      .form-group select:focus {
        outline: none;
        border-color: var(--accent-color);
        box-shadow: 0 0 0 3px rgba(56, 130, 206, 0.1);
      }

      /* Results Display */
      .results {
        color: white;
        padding: var(--spacing-md);
        border-radius: var(--border-radius);
        margin-top: var(--spacing-md);
        box-shadow: 0 4px 12px rgba(13, 110, 253, 0.3);
      }

      .results h3 {
        margin-bottom: var(--spacing-md);
        color: black;
        font-size: 1.2rem;
        font-weight: 700;
      }

      .result-item {
        background: rgba(112, 181, 252, 0.9);
        display: flex;
        justify-content: space-between;
        padding: var(--spacing-sm);
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 4px;
        margin-bottom: var(--spacing-xs);
      }

      .result-item:last-child {
        margin-bottom: 0;
      }

      .result-label {
        font-weight: 600;
        opacity: 0.9;
        color: black;
      }

      .result-value {
        font-weight: bold;
        font-size: 1rem;
      }

      .proposed .results {
        color: black;
        box-shadow: 0 4px 12px rgba(25, 135, 84, 0.3);
      }

      .proposed .result-item {
        background: #d4e1ab;
      }
      /* Savings Section */
      .savings-section {
        background: var(--surface-color);
        padding: var(--spacing-xl);
        border-radius: var(--border-radius);
        margin-bottom: var(--spacing-lg);
        box-shadow: var(--shadow-light);
        text-align: center;
        border: 1px solid var(--border-color);
      }

      .savings-section h2 {
        margin-bottom: var(--spacing-lg);
        font-size: clamp(1.5rem, 4vw, 2rem);
        font-weight: 700;
        color: var(--text-primary);
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .savings-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: var(--spacing-lg);
        margin-top: var(--spacing-lg);
      }

      .savings-item {
        background: var(--surface-color);
        padding: var(--spacing-lg);
        border-radius: var(--border-radius);
        border: 1px solid var(--border-color);
        box-shadow: var(--shadow-light);
        transition: var(--transition);
      }

      .savings-item:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-medium);
      }

      .savings-value {
        font-size: clamp(1.5rem, 5vw, 2.5rem);
        font-weight: 800;
        margin-bottom: var(--spacing-sm);
        color: var(--accent-color);
      }

      .savings-label {
        font-size: 0.875rem;
        color: var(--text-secondary);
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      /* Chart Container */
      .chart-container {
        background: #f8f9fa;
        padding: 25px;
        border-radius: 8px;
        margin-bottom: 25px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        border: 2px solid #e9ecef;
      }

      .chart-content {
        margin-top: 25px;
      }

      .chart-div {
        display: none;
        min-height: 400px;
        background: white;
        border: 2px solid #dee2e6;
        border-radius: 8px;
        padding: 25px;
        text-align: center;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      .chart-div.active {
        display: block;
      }

      .chart-div canvas {
        max-width: 100%;
        height: auto;
      }

      /* Control and Rebate Fields */
      .control-fields,
      .rebate-fields {
        transition: all 0.3s ease;
        opacity: 0;
        transform: translateY(-5px);
      }

      .control-fields.show,
      .rebate-fields.show {
        opacity: 1;
        transform: translateY(0);
      }

      .tabs {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-bottom: 25px;
      }

      .tab {
        padding: 12px 24px;
        background: white;
        border: 2px solid #dee2e6;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 600;
        font-size: 14px;
        transition: all 0.3s ease;
        color: #495057;
      }

      .tab.active {
        background: #0d6efd;
        color: white;
        border-color: #0d6efd;
        box-shadow: 0 2px 8px rgba(13, 110, 253, 0.3);
      }

      .tab:hover:not(.active) {
        background: #f8f9fa;
        border-color: #0d6efd;
        color: #0d6efd;
      }

      /* Footer */
      .footer {
        background: #f8f9fa;
        padding: 25px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        text-align: center;
        border: 2px solid #e9ecef;
      }

      .disclaimer {
        color: #495057;
        font-size: 1rem;
        line-height: 1.6;
        font-weight: 500;
      }

      .disclaimer a {
        color: #0d6efd;
        text-decoration: none;
        font-weight: 600;
        transition: color 0.3s ease;
      }

      .disclaimer a:hover {
        color: #0b5ed7;
        text-decoration: underline;
      }

      /* Responsive Design */
      @media (max-width: 1200px) {
        .container {
          max-width: 100%;
          padding: var(--spacing-sm);
        }
      }

      @media (max-width: 768px) {
        .header {
          flex-direction: column;
          text-align: center;
          gap: var(--spacing-md);
          padding: var(--spacing-sm);
        }

        .header-left {
          justify-content: center;
          flex-direction: column;
          gap: var(--spacing-sm);
        }

        .header-buttons {
          justify-content: center;
          width: 100%;
        }

        .btn {
          flex: 1;
          min-width: 120px;
        }

        .input-group {
          grid-template-columns: 1fr;
          gap: var(--spacing-md);
        }

        .unit-label {
          align-self: center;
          width: fit-content;
        }

        .comparison-container {
          grid-template-columns: 1fr;
          gap: var(--spacing-md);
        }

        .comparison-section {
          padding: var(--spacing-md);
        }

        .savings-grid {
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: var(--spacing-md);
        }

        .savings-section {
          padding: var(--spacing-lg);
        }
      }

      @media (max-width: 480px) {
        .container {
          padding: var(--spacing-xs);
        }

        .header {
          padding: var(--spacing-sm);
        }

        .logo svg {
          width: 50px;
          height: 40px;
        }

        .btn {
          padding: 0.5rem 1rem;
          font-size: 0.8rem;
          min-height: 40px;
        }

        .general-inputs,
        .comparison-section,
        .savings-section {
          padding: var(--spacing-sm);
        }

        .savings-grid {
          grid-template-columns: 1fr;
        }

        .form-group {
          margin-bottom: var(--spacing-sm);
        }
      }

      /* Accessibility Improvements */
      @media (prefers-reduced-motion: reduce) {
        * {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }
      }

      /* Focus Management */
      .btn:focus,
      input:focus,
      select:focus {
        outline: 2px solid var(--accent-color);
        outline-offset: 2px;
      }

      /* Print Styles */
      @media print {
        .header-buttons,
        .btn {
          display: none;
        }

        .container {
          max-width: none;
          padding: 0;
        }

        .comparison-container {
          grid-template-columns: 1fr 1fr;
        }

        .comparison-section,
        .general-inputs,
        .savings-section,
        .footer,
        .chart-container {
          box-shadow: none;
          border: 1px solid #ddd;
          margin-bottom: 15px;
          break-inside: avoid;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <div class="header">
        <div class="header-left">
          <div class="logo">
            <svg
              id="Layer_1"
              data-name="Layer 1"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 1980.69 1641.99"
              width="60"
              height="50"
            >
              <defs>
                <style>
                  .cls-1 {
                    fill: #1c367e;
                  }
                </style>
              </defs>
              <path
                class="cls-1"
                d="M259.94,1174.61c-15.83-15.09-39.76-22.83-60.38-22.83-49,0-81,28-81,84.31,0,36.82,20.25,82.84,81,82.84,18,0,35-3,54.86-18v-41.24H192.94v-47.86H304.12v112.29c-22.09,31.66-57.43,47.86-104.93,47.86-99.4,0-136.95-68.84-136.95-135.85,0-72.52,42.71-136.95,137.32-136.95,35,0,66.64,9.57,96.09,39.76Z"
              />
              <path
                class="cls-1"
                d="M630.3,1364.58H566.61l-65.9-84.68H459.1v84.68H401.67V1106.87H523.9c62.22,0,95.35,41.6,95.35,86.88-.37,33.51-10.31,63.33-59.64,81l70.69,85.41ZM459.1,1156.2v75.11h65.54c26.5,0,37.92-19.88,37.92-36.08-.37-17.67-11.79-39-38.66-39Z"
              />
              <path class="cls-1" d="M720.12,1364.58V1106.87h57.06v257.71Z" />
              <path
                class="cls-1"
                d="M875.11,1106.87h197v25l-123.7,178.93H1075v53.75H868.85v-29.82L994.76,1156.2H875.11Z"
              />
              <path
                class="cls-1"
                d="M1157.85,1106.87h197v25l-123.7,178.93h126.64v53.75H1151.59v-29.82L1277.5,1156.2H1157.85Z"
              />
              <path
                class="cls-1"
                d="M1509.06,1106.87v205.06h128.85v52.65H1451.63V1106.87Z"
              />
              <path
                class="cls-1"
                d="M1787.38,1209.22l65.16-102.35h65.9v3l-103.08,152.41v102.35h-57.43V1262.23l-98.66-152.41v-3h66.26Z"
              />
              <path
                class="cls-1"
                d="M492.36,1458.4v102.11h64.16v26.22H463.76V1458.4Z"
              />
              <path class="cls-1" d="M599.42,1586.73V1458.4h28.41v128.33Z" />
              <path
                class="cls-1"
                d="M773.2,1492.13c-7.88-7.51-19.79-11.36-30.06-11.36-24.38,0-40.33,13.93-40.33,42,0,18.33,10.08,41.25,40.33,41.25,9,0,17.42-1.47,27.32-9v-20.53H739.84v-23.83H795.2v55.91c-11,15.77-28.59,23.83-52.24,23.83-49.5,0-68.2-34.28-68.2-67.64,0-36.12,21.27-68.2,68.38-68.2,17.42,0,33.18,4.77,47.85,19.8Z"
              />
              <path
                class="cls-1"
                d="M929.76,1586.91v-50.78H872.38v50.78h-28.6V1458.58h28.6v51.34h57.38v-51.34H958v128.33Z"
              />
              <path
                class="cls-1"
                d="M1040.11,1483.88h-39V1458.4h106.51v25.48h-39v102.85h-28.42Z"
              />
              <path class="cls-1" d="M1150.66,1586.73V1458.4h28.41v128.33Z" />
              <path
                class="cls-1"
                d="M1322.61,1541.81l-1.84-40.33V1458.4h28.79v128.33H1325l-63.8-82.13,1.11,42.16v40h-29V1458.4h24.56Z"
              />
              <path
                class="cls-1"
                d="M1494.93,1492.13c-7.89-7.51-19.8-11.36-30.07-11.36-24.38,0-40.33,13.93-40.33,42,0,18.33,10.08,41.25,40.33,41.25,9,0,17.42-1.47,27.32-9v-20.53h-30.62v-23.83h55.36v55.91c-11,15.77-28.59,23.83-52.24,23.83-49.5,0-68.2-34.28-68.2-67.64,0-36.12,21.27-68.2,68.38-68.2,17.42,0,33.18,4.77,47.85,19.8Z"
              />
              <path class="cls-1" d="M625.37,145.63l-.07.07.16,0Z" />
              <path
                class="cls-1"
                d="M641.46,444.79c12.26-21.15,15.86-42.62,42.9-43,1.57-50.4,52.55-60,86-81.16-34.63-7-69.1,14.43-92.28,36.24-4.77-2.51-1.19-16.71-1.19-16.71S615.42,377.36,641.46,444.79Z"
              />
              <path
                class="cls-1"
                d="M621,541.85c18-13.14,24.66-11.76,38.38-12.41l-6.48,6c-19.57,21.69-33.42,45.2-23.47,77.16,24.63-47.82,71.91-74.21,110.94-116.29-20.92,2.64-34.85,5-48.88,6C646.19,506.44,615.91,528.29,621,541.85Z"
              />
              <path
                class="cls-1"
                d="M720.15,489.42c-6.42-13.56-34-27.24-48.16-25.26-15.79,2.22-42.26,25.92-44.56,42.28,16.8-4.15,30.66-11.5,46.32-12.29C689.07,493.39,705.26,497.65,720.15,489.42Z"
              />
              <path class="cls-1" d="M1355.25,145.72l.17,0-.08-.07Z" />
              <path
                class="cls-1"
                d="M1296.36,401.76c27,.41,30.64,21.88,42.89,43,26-67.43-35.4-104.66-35.4-104.66s3.58,14.2-1.19,16.71c-23.18-21.81-57.65-43.2-92.28-36.24C1243.8,341.73,1294.78,351.36,1296.36,401.76Z"
              />
              <path
                class="cls-1"
                d="M1289.18,502.31c-14-1-28-3.39-48.88-6,39,42.08,86.32,68.47,110.94,116.29,10-32-3.9-55.47-23.46-77.16l-6.49-6c13.72.65,20.42-.73,38.38,12.41C1364.81,528.29,1334.52,506.44,1289.18,502.31Z"
              />
              <path
                class="cls-1"
                d="M1308.72,464.16c-14.15-2-41.74,11.7-48.15,25.26,14.88,8.23,31.07,4,46.39,4.73,15.66.79,29.53,8.14,46.32,12.29C1351,490.08,1324.51,466.38,1308.72,464.16Z"
              />
              <path
                class="cls-1"
                d="M1444,473.8c-27.46-20.51-38.25-49.21-42.71-81.34-3-21.68-7.5-42.88-17.19-62.39.18-2.07-.34-4.53.59-5.39,36.38-34.66,35.24-84.32,50.18-127.34,27.39-78.82-40-148.36-96.63-145.67-23.17,1.15-41.18,14.87-58.93,26.36-51.91,33.58-106.13,54.54-169.49,50.56-44.41-2.8-84.28,13.94-119.49,39.6-35.17-25.66-75-42.4-119.45-39.6-63.36,4-117.58-17-169.49-50.56-17.78-11.49-35.8-25.21-58.93-26.36-56.62-2.69-124,66.85-96.63,145.67,14.94,43,13.8,92.68,50.18,127.34.93.86.38,3.32.55,5.39-9.64,19.51-14.14,40.71-17.15,62.39-4.46,32.13-15.25,60.83-42.75,81.34-8.78,6.61-22,8.79-25.73,23.38,4.29,14.77,16.4,23.48,30.51,28.7,14.28,5.26,19.19,14.29,18.74,28.85-1.07,34.41-3.94,69,3.49,103.09,5.43,24.87,10.76,50.29,37.63,63.81,6.33-9.93,11.66-18.33,18-28.33,9.86,20.89-1.94,46,19.06,60.63a24.71,24.71,0,0,0,13-9.1c3-3.83,5.22-9.3,8.68-12.62a31.8,31.8,0,0,1,2.21,2.66,19.14,19.14,0,0,1,2.63,5.71c1.11,3.94,1.18,8.13,1.45,12.17,3.43,46.41,28.54,79.34,67.72,100.92,39.6,21.79,76.43,45.79,104.3,82.45a154.16,154.16,0,0,0,48.11,41.12c35.2,19.64,69.75,27.56,103.85,26.9h0c34.1.66,68.65-7.26,103.85-26.9a153.56,153.56,0,0,0,48.07-41.12c27.91-36.66,64.71-60.66,104.31-82.45,39.22-21.58,64.29-54.51,67.71-100.92.31-4,.35-8.23,1.49-12.17a17.35,17.35,0,0,1,2.63-5.71c.66-.93,1.49-1.83,2.21-2.66,3.46,3.32,5.64,8.79,8.65,12.62a24.77,24.77,0,0,0,13,9.1c21-14.59,9.19-39.74,19-60.63,6.39,10,11.72,18.4,18.05,28.33,26.87-13.52,32.2-38.94,37.63-63.81,7.43-34.06,4.56-68.68,3.49-103.09-.45-14.56,4.46-23.59,18.71-28.85s26.25-13.93,30.5-28.7C1466,482.59,1452.83,480.41,1444,473.8ZM1321.59,99c48.9-14.7,95.48,23,91.85,72.42-8.37-4.43-6.19-19.16-22.51-19.92,4.15,41.77,15.35,84.76-17.64,125.71-12.9-35.66,7.43-73.46-24-101.78,13.66-9.27,26.74.86,26.74.86,2-9.54-2.43-15.21-8.17-20.16a14.3,14.3,0,0,1-2.18-1.8c-2.52-2-5.11-3.91-7.47-6a78.13,78.13,0,0,0-10.27-6c6.95-10.65,33.69,2.69,33.69,2.69,3.53-10-2.15-15.56-9.65-19.43-17.67-9.1-36.14-12.07-54.47-2.49-15.25,7.92-29.53,17.6-44.75,25.56-13.39,7-27.46,10.23-42.57-.38C1259,126.76,1288.59,108.91,1321.59,99ZM589.8,151.52c-16.36.76-14.15,15.49-22.52,19.92-3.63-49.39,43-87.12,91.86-72.42,33,9.89,62.56,27.74,91.43,49.32-15.14,10.61-29.18,7.36-42.57.38-15.21-8-29.53-17.64-44.75-25.56-18.33-9.58-36.8-6.61-54.47,2.49-7.5,3.87-13.17,9.44-9.65,19.43,0,0,26.74-13.34,33.69-2.69a75.28,75.28,0,0,0-10.27,6c-2.36,2.07-5,4-7.47,6a14.3,14.3,0,0,1-2.18,1.8c-5.74,4.95-10.2,10.62-8.16,20.16,0,0,13-10.13,26.73-.86-31.47,28.32-11.14,66.12-24,101.78C574.44,236.28,585.65,193.29,589.8,151.52ZM863.42,918.44l.14-.13h0l-.13.14Zm131,57.76c-1.34-.07-2.73-.21-4-.38-1.35.17-2.7.31-4.08.38-45.48,3.08-105.48-25.14-122.6-57.69h0l-.09-.16.11.16c49.35,14.39,78.5,13.11,126.68-6.36,48.17,19.47,77.29,20.75,126.64,6.36l.06-.08a.56.56,0,0,1,0,.08h0C1099.87,951.06,1039.87,979.28,994.42,976.2ZM958.25,793.6c-.1-.07-.21-.11-.31-.18-3.11-1.62-28.71-4-32.06-4.6-13-2.38-2.21,10-1,23.21v.17c-14.67.94-23.45-6.33-25.22-19.4-1.93-14.42,8.69-20.33,21.2-21.92,21.76-2.74,43.58-2.94,65.44-2.67,1.35,0,2.73,0,4.08,0s2.7,0,4,0c21.86-.27,43.68-.07,65.44,2.67,12.52,1.59,23.1,7.5,21.2,21.92-1.77,13.07-10.59,20.34-25.25,19.4l0-.17c1.21-13.18,12-25.59-1-23.21-3.35.63-28.94,3-32.06,4.6-.1.07-.21.11-.31.18-18.5,10.09-7.33,38.45,13.35,34.37,10.1-2,20.51-6.12,29.88-.69-12.1,16.12-43.44,24.45-75.32,25.14-32-.69-63.29-9-75.36-25.14,9.37-5.43,19.78-1.28,29.88.69C965.58,832.05,976.75,803.69,958.25,793.6Zm159,124.85-.14-.13h0l.14.13Zm14.71-48c-3.53,7.82-9.79,12.52-17.26,16.08-31.19,15-63.46,14-95.93,5.88-6.85-1.69-14.7-4.29-15.19-13.9,3.5-5.81,9.62-7.47,15-7.4,50.7.93,72.14-43.89,79.78-84A40.19,40.19,0,0,0,1068,740.27c-25.77-6-51.81-1.52-77.68-1.38-25.83-.14-51.87-4.67-77.64,1.38a40.17,40.17,0,0,0-30.36,46.86c7.64,40.08,29.08,84.9,79.78,84,5.36-.07,11.45,1.59,15,7.4-.49,9.61-8.34,12.21-15.18,13.9-32.48,8.13-64.75,9.13-95.94-5.88-7.47-3.56-13.73-8.26-17.26-16.08-31.43-69.37-20.16-160.88,29.71-216.56,12.07-13.45,29.85-16.36,46.27-21.58,12.8-4,27.22-3.63,41.5-14.87-25.07-21.62-53.32-17.88-80.33-20.2,27.7-14,54.4-.9,83.2,6.23.45-23.07-13.35-30.2-30.15-36.8,14.9-7.13,26-1.94,36.31,5.39a39.73,39.73,0,0,0,11.07,5.81,24.87,24.87,0,0,0,4,1,22.42,22.42,0,0,0,4.08-1,38.53,38.53,0,0,0,11.07-5.78c10.31-7.33,21.41-12.52,36.31-5.39-16.8,6.6-30.6,13.73-30.15,36.8,28.8-7.13,55.5-20.27,83.17-6.23-27,2.32-55.23-1.42-80.3,20.2,14.28,11.24,28.7,10.82,41.5,14.87,16.39,5.22,34.2,8.13,46.27,21.58C1152.16,709.56,1163.43,801.07,1132,870.44Zm248.2-360.57c11.59,54.09,26.67,108.66-.79,163.34-13.21-10-15.74-29.81-35.21-29.19-9.23,16.36-2.38,35.59-11.2,51.77-.28.52-10.52-13.69-11.35-14.94-2.69-3.9-6.84-8.88-11.86-9.58-6.85-1-8.16,7.13-9.44,12.18-1.9,7.5-3.87,15-5.26,22.62-3.21,17.53-3.25,35.69-8.78,52.74a86.51,86.51,0,0,1-27.6,40.53A119.85,119.85,0,0,1,1237,813q-6.18,3.12-12.55,5.64c-2.05.83-12.32,3.15-13.08,4.81,16-35,13.8-69.86,18.47-105.07l29.74,53.43c14.77-26.94,13.9-51.46,12.9-75.7-1-25-14.45-47.14-20.13-72.14,35.28-1.52,59.7,27.63,59.8,24,.59-20-21.44-36.45-29.12-53.36,8.23-3.32,18.74-1.63,30.81,2.63-11.58-24.49-56.92-30.75-83.65-24.59,32.26,20.33,43.57,25.07,51.15,44.51-12.66-6.75-38.22-21.86-48.39-26.91s-20.19-10.27-35.83-6.5c11.28,15,21.93,28.29,31.48,42.26s14.14,34.86,12,50c-36.66-48.73-83.8-85.07-137.34-120.66,54.89,3.56,103.31-13.66,95.18-69,10.27-2.32,20.92,4.91,31.43.21-17.77-42.47-74.63-53-110.14-20.75-15.32,13.9-29.47,29.08-43.82,44-8.68,8.93-18.12,13.28-30.23,8.75-4.39-31.5,10.93-60.14,38.11-74,10.27-5.22,23.07-9.89,17.33-28.56-37.18-2.7-63.56,13.8-81.69,48-5.43-16.36-4.7-18.78,5.26-30.4,34-39.7,80.06-43.3,127.54-42.68,6.06.07,12.56,3.49,18.89-2.59,3.28-14.29-8.16-21.17-17.85-24.8-49.8-18.74-99.43-30.71-140.55,20.47,11.07-43.4,13-89.64,51.4-123.74.76,9.38.76,13.53,7.74,31.16,27.74-28.08,36.25-42.4,58.59-45-10.24,23.59-12.38,25.94-5.47,36.21,20.13-7.44,40.57-16.74,65-18.43-13.14,7.09-20.13,17.18-19.12,32.26,45.71-4.18,91.68-6.08,135.56,14.67-14.35-30.23-42.43-37.53-69.82-44.48-1.66-23.38,4.53-28.11,30.64-42.78-28.08-6.5-54.64-6-81.38,2.7-.65-12.52-.45-15.08,8.17-30.5-35.83-5.64-62.25,21.85-94.73,28.81-7.26-14.53-5.08-18.09,3.53-40.88-33,5.32-48.69,36.9-64.29,61.56-18.92,29.84-27.88,42.5-48.14,61.31-20.3-18.81-29.29-31.43-48.18-61.31-15.59-24.66-31.26-56.24-64.29-61.56,8.61,22.79,10.79,26.35,3.53,40.88-32.47-7-58.93-34.45-94.73-28.81,8.62,15.42,8.82,18,8.13,30.5-26.7-8.68-53.26-9.2-81.34-2.7,26.11,14.67,32.3,19.4,30.64,42.78-27.42,6.95-55.5,14.25-69.82,44.48,43.88-20.75,89.85-18.85,135.57-14.67,1-15.08-6-25.17-19.13-32.26,24.45,1.69,44.86,11,65,18.43,6.88-10.27,4.74-12.62-5.47-36.21,22.34,2.59,30.82,16.91,58.59,45,7-17.63,7-21.78,7.75-31.16C955,294.24,956.94,340.48,968,383.88c-41.12-51.18-90.75-39.21-140.59-20.47-9.64,3.63-21.13,10.51-17.81,24.8,6.33,6.08,12.8,2.66,18.85,2.59,47.52-.62,93.55,3,127.58,42.68,10,11.62,10.69,14,5.26,30.4-18.12-34.17-44.55-50.67-81.69-48-5.74,18.67,7.06,23.34,17.33,28.56,27.18,13.87,42.5,42.51,38.11,74-12.11,4.53-21.58.18-30.23-8.75-14.38-14.87-28.53-30.05-43.82-44-35.51-32.27-92.37-21.72-110.14,20.75,10.51,4.7,21.13-2.53,31.43-.21-8.16,55.37,40.26,72.59,95.18,69C823.93,590.94,776.82,627.28,740.17,676c-2.15-15.18,2.35-35.93,12-50s20.19-27.22,31.43-42.26c-15.6-3.77-25.52,1.42-35.79,6.5s-35.73,20.16-48.38,26.91c7.57-19.44,18.88-24.18,51.14-44.51-26.73-6.16-72.1.1-83.69,24.59,12.11-4.26,22.62-6,30.85-2.63C690,611.48,668,627.94,668.58,647.93c.14,3.63,24.52-25.52,59.83-24-5.67,25-19.13,47.1-20.13,72.14-1,24.24-1.87,48.76,12.9,75.7,11.38-20.5,20.54-37,29.71-53.43,4.7,35.21,2.52,70.07,18.5,105.07-.76-1.66-11.07-4-13.07-4.81-4.26-1.69-8.48-3.56-12.59-5.64A120.65,120.65,0,0,1,722,799.34a86.57,86.57,0,0,1-27.63-40.53c-5.5-17-5.57-35.21-8.75-52.74-1.42-7.61-3.36-15.12-5.26-22.62-1.28-5.05-2.63-13.14-9.44-12.18-5,.7-9.17,5.68-11.86,9.58-.87,1.25-11.07,15.46-11.35,14.94-8.82-16.18-2-35.41-11.2-51.77-19.47-.62-22,19.23-35.21,29.19-27.46-54.68-12.41-109.25-.79-163.34-13.53-7.23-29.75,4-41.68-12.07,26-15.66,37.08-41.84,47.69-68.54,4.5-11.38,8.1-22.83,9.06-34.86,4.57-55.85,22.24-107.94,48.63-156.63C678.78,210.86,708,198.2,734.67,188c75.15-28.67,151.78-35,228.28-2.87,7.65,3.18,15.32,6.33,23.35,9.55V198c1.38-.56,2.73-1.11,4.08-1.63,1.35.52,2.7,1.07,4,1.63v-3.32c8-3.22,15.7-6.37,23.31-9.55,76.5-32.09,153.14-25.8,228.29,2.87,26.73,10.2,55.92,22.86,70.48,49.77,26.35,48.69,44.06,100.78,48.59,156.63,1,12,4.6,23.48,9.1,34.86,10.61,26.7,21.72,52.88,47.69,68.54C1410,513.82,1393.73,502.64,1380.2,509.87Zm-199.34-23.72s6.51,64.19-77.15,51.46C1103.71,537.61,1167.27,539.55,1180.86,486.15Zm-60.34,12.1a7.23,7.23,0,1,1,7.22,7.23A7.22,7.22,0,0,1,1120.52,498.25ZM877,537.61c-83.66,12.73-77.19-51.46-77.19-51.46C813.41,539.55,877,537.61,877,537.61Zm-31.26-39.36a7.21,7.21,0,1,1,7.23,7.23A7.2,7.2,0,0,1,845.75,498.25Z"
              />
            </svg>
          </div>
          <h1>Simple Economic Tool</h1>
        </div>
        <div class="header-buttons">
          <button class="btn btn-primary" onclick="toggleControls()">
            Add Control
          </button>
          <button class="btn btn-primary" onclick="toggleRebates()">
            Add Rebate
          </button>
          <button class="btn btn-secondary" onclick="printResults()">
            Print
          </button>
        </div>
      </div>

      <!-- General Inputs -->
      <div class="general-inputs">
        <h2>General Parameters</h2>
        <div class="input-group">
          <div class="input-field">
            <label for="electricityRate">Electricity Rate</label>
            <input
              type="number"
              id="electricityRate"
              value="10"
              min="0"
              step="0.01"
              onchange="calculateAll()"
            />
          </div>
          <div class="unit-label">kWh</div>

          <div class="input-field">
            <label for="operationHours">Operation Hours</label>
            <input
              type="number"
              id="operationHours"
              value="12"
              min="0"
              max="24"
              step="0.5"
              onchange="calculateAll()"
            />
          </div>
          <div class="unit-label">day</div>
        </div>
      </div>

      <!-- Comparison Sections -->
      <div class="comparison-container">
        <!-- Baseline Section -->
        <div class="comparison-section baseline">
          <h2>Baseline</h2>
          <div class="form-group">
            <label for="baselineDescription">Description/Catalog</label>
            <input
              type="text"
              id="baselineDescription"
              value="Test"
              placeholder="Enter current lighting description"
              onchange="calculateAll()"
            />
          </div>
          <div class="form-group">
            <label for="baselineQuantity">Quantity</label>
            <input
              type="number"
              id="baselineQuantity"
              value="10"
              min="0"
              onchange="calculateAll()"
            />
          </div>
          <div class="form-group">
            <label for="baselineWatts">Watts Per Luminaire</label>
            <input
              type="number"
              id="baselineWatts"
              value="70"
              min="0"
              onchange="calculateAll()"
            />
          </div>
          <div class="form-group">
            <label for="baselineCost">Cost Per Luminaire</label>
            <input
              type="number"
              id="baselineCost"
              value="12"
              min="0"
              step="0.01"
              onchange="calculateAll()"
            />
          </div>

          <!-- Control Fields (Hidden by default) -->
          <h3
            style="
              margin-top: 25px;
              margin-bottom: 20px;
              color: #495057;
              font-size: 1rem;
              font-weight: 700;
              text-transform: uppercase;
              letter-spacing: 0.5px;
              border-bottom: 2px solid #dee2e6;
              padding-bottom: 10px;
            "
          >
            Lighting Control
          </h3>
          <div class="form-group control-fields" style="display: none">
            <label for="baselineControlQty">Control Quantity</label>
            <input
              type="number"
              id="baselineControlQty"
              value="12"
              min="0"
              onchange="calculateAll()"
            />
          </div>
          <div class="form-group control-fields" style="display: none">
            <label for="baselineControlReduction">Control Reduction (%)</label>
            <input
              type="number"
              id="baselineControlReduction"
              value="1"
              min="0"
              max="100"
              onchange="calculateAll()"
            />
          </div>
          <div class="form-group control-fields" style="display: none">
            <label for="baselineControlCost">Control Cost</label>
            <input
              type="number"
              id="baselineControlCost"
              value="1"
              min="0"
              step="0.01"
              onchange="calculateAll()"
            />
          </div>

          <!-- Rebate Fields (Hidden by default) -->
          <h3
            style="
              margin-top: 25px;
              margin-bottom: 20px;
              color: #495057;
              font-size: 1.3rem;
              font-weight: 700;
              text-transform: uppercase;
              letter-spacing: 0.5px;
              border-bottom: 2px solid #dee2e6;
              padding-bottom: 10px;
            "
          >
            Rebates/Incidental Costs
          </h3>
          <div class="form-group rebate-fields" style="display: none">
            <label for="baselineRebateDescription">Rebate Description</label>
            <input
              type="text"
              id="baselineRebateDescription"
              placeholder="Enter rebate description"
              onchange="calculateAll()"
            />
          </div>
          <div class="form-group rebate-fields" style="display: none">
            <label for="baselineRebateValue">Rebate Value</label>
            <input
              type="text"
              id="baselineRebateValue"
              value="500"
              placeholder="Enter rebate value or calculation (e.g., 100 or 0.1*x)"
              onchange="calculateAll()"
            />
          </div>

          <!-- Baseline Results -->
          <div class="results">
            <h3>Baseline Results</h3>
            <div class="result-item">
              <span class="result-label">Initial Cost:</span>
              <span class="result-value" id="baselineInitialCost">$0</span>
            </div>
            <div class="result-item">
              <span class="result-label">Annual Energy Usage:</span>
              <span class="result-value" id="baselineAnnualEnergy"
                >0.00 kWh</span
              >
            </div>
            <div class="result-item">
              <span class="result-label">Annual Cost:</span>
              <span class="result-value" id="baselineAnnualCost">$0</span>
            </div>
          </div>
        </div>

        <!-- Proposed Section -->
        <div class="comparison-section proposed">
          <h2>Proposed</h2>
          <div class="form-group">
            <label for="proposedProduct">Product Selection</label>
            <select id="proposedProduct" onchange="updateProposedWatts()">
              <option value="">Select a product...</option>
              <!-- Product options will be populated by JavaScript -->
            </select>
          </div>
          <!-- <div class="form-group">
            <label for="proposedDescription">Description/Catalog</label>
            <input
              type="text"
              id="proposedDescription"
              placeholder="Product description"
              readonly
            />
          </div> -->
          <div class="form-group">
            <label for="proposedQuantity">Quantity</label>
            <input
              type="number"
              id="proposedQuantity"
              value="10"
              min="0"
              onchange="calculateAll()"
            />
          </div>
          <div class="form-group">
            <label for="proposedWatts">Watts Per Luminaire</label>
            <input
              type="number"
              id="proposedWatts"
              value="70"
              min="0"
              readonly
            />
          </div>
          <div class="form-group">
            <label for="proposedCost">Cost Per Luminaire</label>
            <input
              type="number"
              id="proposedCost"
              value="12"
              min="0"
              step="0.01"
              onchange="calculateAll()"
            />
          </div>

          <!-- Control Fields (Hidden by default) -->
          <h3
            style="
              margin-top: 25px;
              margin-bottom: 20px;
              color: #495057;
              font-size: 1rem;
              font-weight: 700;
              text-transform: uppercase;
              letter-spacing: 0.5px;
              border-bottom: 2px solid #dee2e6;
              padding-bottom: 10px;
            "
          >
            Lighting Control
          </h3>
          <div class="form-group control-fields" style="display: none">
            <label for="proposedControlQty">Control Quantity</label>
            <input
              type="number"
              id="proposedControlQty"
              value="12"
              min="0"
              onchange="calculateAll()"
            />
          </div>
          <div class="form-group control-fields" style="display: none">
            <label for="proposedControlReduction">Control Reduction (%)</label>
            <input
              type="number"
              id="proposedControlReduction"
              value="0"
              min="0"
              max="100"
              onchange="calculateAll()"
            />
          </div>
          <div class="form-group control-fields" style="display: none">
            <label for="proposedControlCost">Control Cost</label>
            <input
              type="number"
              id="proposedControlCost"
              value="0"
              min="0"
              step="0.01"
              onchange="calculateAll()"
            />
          </div>

          <!-- Rebate Fields (Hidden by default) -->
          <h3
            style="
              margin-top: 25px;
              margin-bottom: 20px;
              color: #495057;
              font-size: 1.3rem;
              font-weight: 700;
              text-transform: uppercase;
              letter-spacing: 0.5px;
              border-bottom: 2px solid #dee2e6;
              padding-bottom: 10px;
            "
          >
            Rebates/Incidental Costs
          </h3>
          <div class="form-group rebate-fields" style="display: none">
            <label for="proposedRebateDescription">Rebate Description</label>
            <input
              type="text"
              id="proposedRebateDescription"
              placeholder="Enter rebate description"
              onchange="calculateAll()"
            />
          </div>
          <div class="form-group rebate-fields" style="display: none">
            <label for="proposedRebateValue">Rebate Value</label>
            <input
              type="text"
              id="proposedRebateValue"
              value="500"
              placeholder="Enter rebate value or calculation (e.g., 100 or 0.1*x)"
              onchange="calculateAll()"
            />
          </div>

          <!-- Proposed Results -->
          <div class="results">
            <h3>Proposed Results</h3>
            <div class="result-item">
              <span class="result-label">Initial Cost:</span>
              <span class="result-value" id="proposedInitialCost">$0</span>
            </div>
            <div class="result-item">
              <span class="result-label">Annual Energy Usage:</span>
              <span class="result-value" id="proposedAnnualEnergy"
                >0.00 kWh</span
              >
            </div>
            <div class="result-item">
              <span class="result-label">Annual Cost:</span>
              <span class="result-value" id="proposedAnnualCost">$0</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Savings Section -->
      <div class="savings-section">
        <h2>Economic Analysis</h2>
        <div class="savings-grid">
          <div class="savings-item">
            <div class="savings-value" id="annualSavings">$0</div>
            <div class="savings-label">Annual Savings</div>
          </div>
          <div class="savings-item">
            <div class="savings-value" id="paybackPeriod">0.0</div>
            <div class="savings-label">Payback Period (Years)</div>
          </div>
          <div class="savings-item">
            <div class="savings-value" id="roiPercentage">0%</div>
            <div class="savings-label">ROI</div>
          </div>
          <div class="savings-item">
            <div class="savings-value" id="tenYearSavings">$0</div>
            <div class="savings-label">10-Year Savings</div>
          </div>
        </div>
      </div>

      <!-- Chart Container -->
      <div class="chart-container">
        <div class="tabs">
          <button class="tab active" onclick="showTab('tenYear')">
            10 Year
          </button>
          <button class="tab" onclick="showTab('cashflow')">Cashflow</button>
        </div>
        <div class="chart-content">
          <div id="chart_div" class="chart-div active"></div>
          <div id="cashflow_div" class="chart-div"></div>
        </div>
      </div>
    </div>

    <!-- Chart.js for charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
      // Product Catalog Data
      const productCatalog = [
        // Tundra Area Light Series
        {
          id: "tundra-70",
          name: "Tundra Area Light - 70 Watt",
          watts: 70,
          category: "Tundra Area Light",
        },
        {
          id: "tundra-100",
          name: "Tundra Area Light - 100 Watt",
          watts: 100,
          category: "Tundra Area Light",
        },
        {
          id: "tundra-150",
          name: "Tundra Area Light - 150 Watt",
          watts: 150,
          category: "Tundra Area Light",
        },
        {
          id: "tundra-200",
          name: "Tundra Area Light - 200 Watt",
          watts: 200,
          category: "Tundra Area Light",
        },
        {
          id: "tundra-240",
          name: "Tundra Area Light - 240 Watt",
          watts: 240,
          category: "Tundra Area Light",
        },
        {
          id: "tundra-300",
          name: "Tundra Area Light - 300 Watt",
          watts: 300,
          category: "Tundra Area Light",
        },

        // Orbix Round UFO Light Series
        {
          id: "orbix-70",
          name: "Orbix Round UFO Light - 70 Watt",
          watts: 70,
          category: "Orbix Round UFO Light",
        },
        {
          id: "orbix-100",
          name: "Orbix Round UFO Light - 100 Watt",
          watts: 100,
          category: "Orbix Round UFO Light",
        },
        {
          id: "orbix-150",
          name: "Orbix Round UFO Light - 150 Watt",
          watts: 150,
          category: "Orbix Round UFO Light",
        },
        {
          id: "orbix-180",
          name: "Orbix Round UFO Light - 180 Watt",
          watts: 180,
          category: "Orbix Round UFO Light",
        },
        {
          id: "orbix-200",
          name: "Orbix Round UFO Light - 200 Watt",
          watts: 200,
          category: "Orbix Round UFO Light",
        },
        {
          id: "orbix-240",
          name: "Orbix Round UFO Light - 240 Watt",
          watts: 240,
          category: "Orbix Round UFO Light",
        },

        // Alpine LED Wall Pack Light Series
        {
          id: "alpine-80",
          name: "Alpine LED Wall Pack Light - 80 Watt",
          watts: 80,
          category: "Alpine LED Wall Pack Light",
        },
        {
          id: "alpine-100",
          name: "Alpine LED Wall Pack Light - 100 Watt",
          watts: 100,
          category: "Alpine LED Wall Pack Light",
        },
        {
          id: "alpine-120",
          name: "Alpine LED Wall Pack Light - 120 Watt",
          watts: 120,
          category: "Alpine LED Wall Pack Light",
        },

        // Raven Backlit Flat Panel Light 2x4 Series
        {
          id: "raven-2x4-30",
          name: "Raven Backlit Flat Panel Light 2x4 - 30 Watt",
          watts: 30,
          category: "Raven Backlit Flat Panel Light 2x4",
        },
        {
          id: "raven-2x4-40",
          name: "Raven Backlit Flat Panel Light 2x4 - 40 Watt",
          watts: 40,
          category: "Raven Backlit Flat Panel Light 2x4",
        },
        {
          id: "raven-2x4-50",
          name: "Raven Backlit Flat Panel Light 2x4 - 50 Watt",
          watts: 50,
          category: "Raven Backlit Flat Panel Light 2x4",
        },
        {
          id: "raven-2x4-60",
          name: "Raven Backlit Flat Panel Light 2x4 - 60 Watt",
          watts: 60,
          category: "Raven Backlit Flat Panel Light 2x4",
        },
        {
          id: "raven-2x4-72",
          name: "Raven Backlit Flat Panel Light 2x4 - 72 Watt",
          watts: 72,
          category: "Raven Backlit Flat Panel Light 2x4",
        },

        // Raven Backlit Flat Panel Light 2x2/1x4 Series
        {
          id: "raven-2x2-15",
          name: "Raven Backlit Flat Panel Light 2x2/1x4 - 15 Watt",
          watts: 15,
          category: "Raven Backlit Flat Panel Light 2x2/1x4",
        },
        {
          id: "raven-2x2-20",
          name: "Raven Backlit Flat Panel Light 2x2/1x4 - 20 Watt",
          watts: 20,
          category: "Raven Backlit Flat Panel Light 2x2/1x4",
        },
        {
          id: "raven-2x2-25",
          name: "Raven Backlit Flat Panel Light 2x2/1x4 - 25 Watt",
          watts: 25,
          category: "Raven Backlit Flat Panel Light 2x2/1x4",
        },
        {
          id: "raven-2x2-30",
          name: "Raven Backlit Flat Panel Light 2x2/1x4 - 30 Watt",
          watts: 30,
          category: "Raven Backlit Flat Panel Light 2x2/1x4",
        },
        {
          id: "raven-2x2-40",
          name: "Raven Backlit Flat Panel Light 2x2/1x4 - 40 Watt",
          watts: 40,
          category: "Raven Backlit Flat Panel Light 2x2/1x4",
        },
      ];

      // Initialize the calculator
      document.addEventListener("DOMContentLoaded", function () {
        populateProductDropdown();
        loadSavedData();

        document.querySelectorAll(".control-fields").forEach((field) => {
          field.style.display = "block";
          field.classList.add("show");
        });
        document.querySelectorAll(".rebate-fields").forEach((field) => {
          field.style.display = "block";
          field.classList.add("show");
        });

        // Update button text
        document.querySelector(
          'button[onclick="toggleControls()"]'
        ).textContent = "Hide Control";
        document.querySelector(
          'button[onclick="toggleRebates()"]'
        ).textContent = "Hide Rebate";

        setTimeout(() => {
          const select = document.getElementById("proposedProduct");
          select.value = "tundra-70";
          updateProposedWatts();
        }, 100);

        calculateAll();
      });

      function populateProductDropdown() {
        const select = document.getElementById("proposedProduct");
        select.innerHTML = '<option value="">Select a product...</option>';

        const categories = {};
        productCatalog.forEach((product) => {
          if (!categories[product.category]) {
            categories[product.category] = [];
          }
          categories[product.category].push(product);
        });

        Object.keys(categories).forEach((category) => {
          const optgroup = document.createElement("optgroup");
          optgroup.label = category;

          categories[category].forEach((product) => {
            const option = document.createElement("option");
            option.value = product.id;
            option.textContent = product.name;
            optgroup.appendChild(option);
          });

          select.appendChild(optgroup);
        });
      }

      function updateProposedWatts() {
        const select = document.getElementById("proposedProduct");
        const wattsInput = document.getElementById("proposedWatts");
        const descriptionInput = document.getElementById("proposedDescription");

        if (select.value) {
          const selectedProduct = productCatalog.find(
            (p) => p.id === select.value
          );
          if (selectedProduct) {
            wattsInput.value = selectedProduct.watts;
            descriptionInput.value = selectedProduct.name;
          }
        } else {
          wattsInput.value = "";
          descriptionInput.value = "";
        }

        calculateAll();
      }

      function calculateAll() {
        // Get input values
        const electricityRate =
          parseFloat(document.getElementById("electricityRate").value) || 0;
        const operationHours =
          parseFloat(document.getElementById("operationHours").value) || 0;

        // Baseline calculations
        const baselineQuantity =
          parseInt(document.getElementById("baselineQuantity").value) || 0;
        const baselineWatts =
          parseFloat(document.getElementById("baselineWatts").value) || 0;
        const baselineCost =
          parseFloat(document.getElementById("baselineCost").value) || 0;

        const baselineControlQty =
          parseFloat(document.getElementById("baselineControlQty")?.value) || 0;
        const baselineControlReduction =
          parseFloat(
            document.getElementById("baselineControlReduction")?.value
          ) || 0;
        const baselineControlCost =
          parseFloat(document.getElementById("baselineControlCost")?.value) ||
          0;
        const baselineRebateValue = parseRebateValue(
          document.getElementById("baselineRebateValue")?.value
        );

        // Proposed calculations
        const proposedQuantity =
          parseInt(document.getElementById("proposedQuantity").value) || 0;
        const proposedWatts =
          parseFloat(document.getElementById("proposedWatts").value) || 0;
        const proposedCost =
          parseFloat(document.getElementById("proposedCost").value) || 0;

        const proposedControlQty =
          parseFloat(document.getElementById("proposedControlQty")?.value) || 0;
        const proposedControlReduction =
          parseFloat(
            document.getElementById("proposedControlReduction")?.value
          ) || 0;
        const proposedControlCost =
          parseFloat(document.getElementById("proposedControlCost")?.value) ||
          0;
        const proposedRebateValue = parseRebateValue(
          document.getElementById("proposedRebateValue")?.value
        );

        // Calculate baseline metrics with controls
        let baselineAnnualEnergy =
          (baselineQuantity * baselineWatts * operationHours * 365) / 1000;
        if (baselineControlQty > 0 && baselineControlReduction > 0) {
          baselineAnnualEnergy =
            baselineAnnualEnergy * (1 - baselineControlReduction / 100);
        }
        const baselineAnnualCost =
          baselineAnnualEnergy * (electricityRate / 100);
        let baselineInitialCost = baselineQuantity * baselineCost;
        if (baselineControlQty > 0 && baselineControlCost > 0) {
          baselineInitialCost += baselineControlQty * baselineControlCost;
        }
        if (baselineRebateValue > 0) {
          baselineInitialCost -= baselineRebateValue;
        }

        // Calculate proposed metrics with controls
        let proposedAnnualEnergy =
          (proposedQuantity * proposedWatts * operationHours * 365) / 1000;
        if (proposedControlQty > 0 && proposedControlReduction > 0) {
          proposedAnnualEnergy =
            proposedAnnualEnergy * (1 - proposedControlReduction / 100);
        }
        const proposedAnnualCost =
          proposedAnnualEnergy * (electricityRate / 100);
        let proposedInitialCost = proposedQuantity * proposedCost;
        if (proposedControlQty > 0 && proposedControlCost > 0) {
          proposedInitialCost += proposedControlQty * proposedControlCost;
        }
        if (proposedRebateValue > 0) {
          proposedInitialCost -= proposedRebateValue;
        }

        // Calculate savings and ROI
        const annualSavings = baselineAnnualCost - proposedAnnualCost;
        const paybackPeriod =
          proposedInitialCost > 0 && annualSavings > 0
            ? proposedInitialCost / annualSavings
            : 0;
        const roiPercentage =
          proposedInitialCost > 0
            ? (annualSavings / proposedInitialCost) * 100
            : 0;
        const tenYearSavings = annualSavings * 10;

        // Update display
        updateDisplay(
          "baselineInitialCost",
          formatCurrency(baselineInitialCost)
        );
        updateDisplay(
          "baselineAnnualEnergy",
          formatEnergy(baselineAnnualEnergy)
        );
        updateDisplay("baselineAnnualCost", formatCurrency(baselineAnnualCost));

        updateDisplay(
          "proposedInitialCost",
          formatCurrency(proposedInitialCost)
        );
        updateDisplay(
          "proposedAnnualEnergy",
          formatEnergy(proposedAnnualEnergy)
        );
        updateDisplay("proposedAnnualCost", formatCurrency(proposedAnnualCost));

        updateDisplay("annualSavings", formatCurrency(annualSavings));
        updateDisplay("paybackPeriod", formatYears(paybackPeriod));
        updateDisplay("roiPercentage", formatPercentage(roiPercentage));
        updateDisplay("tenYearSavings", formatCurrency(tenYearSavings));

        // Draw charts
        drawCharts(
          baselineInitialCost,
          proposedInitialCost,
          baselineAnnualCost,
          proposedAnnualCost
        );

        // Save data
        saveData();
      }

      function parseRebateValue(value) {
        if (!value || value === "") return 0;

        try {
          // Replace 'x' with '*' for multiplication
          const expression = value.replace(/x/g, "*");
          const result = eval(expression);
          return isNaN(result) ? 0 : parseFloat(result);
        } catch (e) {
          return 0;
        }
      }

      // Chart drawing functions
      function drawCharts(
        baselineInitial,
        proposedInitial,
        baselineAnnual,
        proposedAnnual
      ) {
        drawTenYearChart(
          baselineInitial,
          proposedInitial,
          baselineAnnual,
          proposedAnnual
        );
        drawCashflowChart(
          baselineInitial,
          proposedInitial,
          baselineAnnual,
          proposedAnnual
        );
      }

      function drawTenYearChart(
        baselineInitial,
        proposedInitial,
        baselineAnnual,
        proposedAnnual
      ) {
        const ctx = document.getElementById("chart_div");
        if (!ctx) return;

        // Clear previous chart
        ctx.innerHTML = '<canvas id="tenYearChart"></canvas>';
        const canvas = document.getElementById("tenYearChart");

        const years = 11;
        const baselineData = [];
        const proposedData = [];
        const labels = [];

        for (let i = 0; i < years; i++) {
          if (i === 0) {
            labels[i] = "Initial";
            baselineData[i] = baselineInitial;
            proposedData[i] = proposedInitial;
          } else {
            labels[i] = `Year ${i}`;
            baselineData[i] = baselineData[i - 1] + baselineAnnual;
            proposedData[i] = proposedData[i - 1] + proposedAnnual;
          }
        }

        new Chart(canvas, {
          type: "bar",
          data: {
            labels: labels,
            datasets: [
              {
                label: "Baseline",
                data: baselineData,
                backgroundColor: "rgba(48, 118, 185, 0.8)",
                borderColor: "rgba(48, 118, 185, 1)",
                borderWidth: 1,
              },
              {
                label: "Proposed",
                data: proposedData,
                backgroundColor: "rgba(147, 182, 78, 0.8)",
                borderColor: "rgba(147, 182, 78, 1)",
                borderWidth: 1,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              title: {
                display: true,
                text: "Accumulated Purchase and Electricity Costs",
              },
            },
            scales: {
              y: {
                beginAtZero: true,
                title: {
                  display: true,
                  text: "Cost ($)",
                },
              },
            },
          },
        });
      }

      function drawCashflowChart(
        baselineInitial,
        proposedInitial,
        baselineAnnual,
        proposedAnnual
      ) {
        const ctx = document.getElementById("cashflow_div");
        if (!ctx) return;

        // Clear previous chart
        ctx.innerHTML = '<canvas id="cashflowChart"></canvas>';
        const canvas = document.getElementById("cashflowChart");

        const years = 11;
        const cashflowData = [];
        const labels = [];

        for (let i = 0; i < years; i++) {
          if (i === 0) {
            labels[i] = "Initial";
            cashflowData[i] = baselineInitial - proposedInitial;
          } else {
            labels[i] = `Year ${i}`;
            cashflowData[i] =
              cashflowData[i - 1] + (baselineAnnual - proposedAnnual);
          }
        }

        new Chart(canvas, {
          type: "bar",
          data: {
            labels: labels,
            datasets: [
              {
                label: "Cash Flow",
                data: cashflowData,
                backgroundColor: "rgba(147, 182, 78, 0.8)",
                borderColor: "rgba(147, 182, 78, 1)",
                borderWidth: 1,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              title: {
                display: true,
                text: "Accumulated Cash Flow",
              },
            },
            scales: {
              y: {
                beginAtZero: true,
                title: {
                  display: true,
                  text: "Cash Flow ($)",
                },
              },
            },
          },
        });
      }

      // Helper functions
      function formatCurrency(value) {
        return (
          "$" +
          value.toLocaleString("en-US", {
            minimumFractionDigits: 2,
            maximumFractionDigits: 2,
          })
        );
      }

      function formatEnergy(value) {
        return (
          value.toLocaleString("en-US", {
            minimumFractionDigits: 2,
            maximumFractionDigits: 2,
          }) + " kWh"
        );
      }

      function formatYears(value) {
        return value.toLocaleString("en-US", {
          minimumFractionDigits: 1,
          maximumFractionDigits: 1,
        });
      }

      function formatPercentage(value) {
        return (
          value.toLocaleString("en-US", {
            minimumFractionDigits: 1,
            maximumFractionDigits: 1,
          }) + "%"
        );
      }

      // Update display elements
      function updateDisplay(elementId, value) {
        const element = document.getElementById(elementId);
        if (element) {
          element.textContent = value;
        }
      }

      // Data persistence
      function saveData() {
        const data = {
          electricityRate: document.getElementById("electricityRate").value,
          operationHours: document.getElementById("operationHours").value,
          baselineQuantity: document.getElementById("baselineQuantity").value,
          baselineWatts: document.getElementById("baselineWatts").value,
          baselineCost: document.getElementById("baselineCost").value,
          baselineDescription: document.getElementById("baselineDescription")
            .value,
          baselineControlQty:
            document.getElementById("baselineControlQty")?.value || 0,
          baselineControlReduction:
            document.getElementById("baselineControlReduction")?.value || 0,
          baselineControlCost:
            document.getElementById("baselineControlCost")?.value || 0,
          baselineRebateDescription:
            document.getElementById("baselineRebateDescription")?.value || "",
          baselineRebateValue:
            document.getElementById("baselineRebateValue")?.value || "",
          proposedProduct: document.getElementById("proposedProduct").value,
          proposedQuantity: document.getElementById("proposedQuantity").value,
          proposedCost: document.getElementById("proposedCost").value,
          proposedDescription: document.getElementById("proposedDescription")
            .value,
          proposedControlQty:
            document.getElementById("proposedControlQty")?.value || 0,
          proposedControlReduction:
            document.getElementById("proposedControlReduction")?.value || 0,
          proposedControlCost:
            document.getElementById("proposedControlCost")?.value || 0,
          proposedRebateDescription:
            document.getElementById("proposedRebateDescription")?.value || "",
          proposedRebateValue:
            document.getElementById("proposedRebateValue")?.value || "",
        };
        localStorage.setItem("ledCalculatorData", JSON.stringify(data));
      }

      function loadSavedData() {
        const saved = localStorage.getItem("ledCalculatorData");
        if (saved) {
          try {
            const data = JSON.parse(saved);
            Object.keys(data).forEach((key) => {
              const element = document.getElementById(key);
              if (element && data[key] !== undefined) {
                element.value = data[key];
              }
            });

            if (data.proposedProduct) {
              updateProposedWatts();
            }

            if (
              data.baselineControlQty ||
              data.baselineControlReduction ||
              data.baselineControlCost
            ) {
              document.querySelectorAll(".control-fields").forEach((field) => {
                field.style.display = "block";
                field.classList.add("show");
              });
              document.querySelector(
                'button[onclick="toggleControls()"]'
              ).textContent = "Hide Control";
            }

            if (data.baselineRebateValue || data.proposedRebateValue) {
              document.querySelectorAll(".rebate-fields").forEach((field) => {
                field.style.display = "block";
                field.classList.add("show");
              });
              document.querySelector(
                'button[onclick="toggleRebates()"]'
              ).textContent = "Hide Rebate";
            }
          } catch (e) {
            console.error("Error loading saved data:", e);
          }
        }
      }

      // Tab functionality
      function showTab(tabName) {
        const tabs = document.querySelectorAll(".tab");
        tabs.forEach((tab) => tab.classList.remove("active"));

        const activeTab = event.target;
        activeTab.classList.add("active");

        // Show/hide appropriate chart
        const chartDiv = document.getElementById("chart_div");
        const cashflowDiv = document.getElementById("cashflow_div");

        if (tabName === "tenYear") {
          chartDiv.classList.add("active");
          cashflowDiv.classList.remove("active");
        } else if (tabName === "cashflow") {
          chartDiv.classList.remove("active");
          cashflowDiv.classList.add("active");
        }
      }

      // Control and Rebate Toggle Functions
      function toggleControls() {
        const controlFields = document.querySelectorAll(".control-fields");
        const controlBtn = event.target;

        controlFields.forEach((field) => {
          if (field.style.display === "none") {
            field.style.display = "block";
            field.classList.add("show");
          } else {
            field.style.display = "none";
            field.classList.remove("show");
          }
        });

        controlBtn.textContent =
          controlBtn.textContent === "Add Control"
            ? "Hide Control"
            : "Add Control";
        calculateAll();
      }

      function toggleRebates() {
        const rebateFields = document.querySelectorAll(".rebate-fields");
        const rebateBtn = event.target;

        rebateFields.forEach((field) => {
          if (field.style.display === "none") {
            field.style.display = "block";
            field.classList.add("show");
          } else {
            field.style.display = "none";
            field.classList.remove("show");
          }
        });

        rebateBtn.textContent =
          rebateBtn.textContent === "Add Rebate" ? "Hide Rebate" : "Add Rebate";
        calculateAll();
      }

      // Action buttons
      function addControl() {
        alert(
          "Add Control functionality - This would integrate with your control system to provide more accurate energy savings calculations."
        );
      }

      function addRebate() {
        alert(
          "Add Rebate functionality - This would allow users to input available rebates and incentives to improve ROI calculations."
        );
      }

      function printResults() {
        window.print();
      }

      function showDisclaimer() {
        alert(
          "Disclaimer: This calculator provides estimates based on the information provided. Actual results may vary. Please consult with a qualified professional for detailed analysis."
        );
      }

      // Input validation
      function validateInput(input) {
        const value = parseFloat(input.value);
        if (value < 0) {
          input.value = 0;
        }
        calculateAll();
      }

      document.addEventListener("input", function (e) {
        if (e.target.type === "number") {
          validateInput(e.target);
        }
      });

      document.addEventListener("input", function (e) {
        if (
          e.target.id &&
          (e.target.id.includes("Control") || e.target.id.includes("Rebate"))
        ) {
          calculateAll();
        }
      });
    </script>
  </body>
</html>
